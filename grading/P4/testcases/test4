tid=`basename $0`
mount=mount/$tid

mkdir -p $mount
. $(dirname $0)/mount.sh $mount; mountcode=$?

if [ "$mountcode" -ne 0 ]; then
        exit $mountcode
fi

mkdir $mount/dir1
mkdir $mount/dir2
returncode=1
output=`ls $mount | tr -d '\n'`
output_expect="dir1dir2"
if [ "$output" = "$output_expect" ]; then
    returncode=0
fi

fusermount -u $mount
exit $returncode
